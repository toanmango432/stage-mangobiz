# Mosquitto Configuration for Mango POS
# Part of: MQTT Architecture Implementation (Phase 2)

# =============================================================================
# General Settings
# =============================================================================

# Allow anonymous connections (secured via LAN isolation)
allow_anonymous true

# Persistence for message storage during restarts
persistence true
persistence_location /tmp/mosquitto/

# Logging
log_dest stdout
log_type error
log_type warning
log_type notice
log_type information

# =============================================================================
# Listener Configuration
# =============================================================================

# Main TCP listener on all interfaces (LAN access)
listener 1883 0.0.0.0

# WebSocket listener for browser clients
listener 9001 0.0.0.0
protocol websockets

# =============================================================================
# Connection Limits
# =============================================================================

# Maximum simultaneous connections
max_connections 50

# Maximum queued messages per client
max_queued_messages 1000

# Maximum packet size (1MB)
max_packet_size 1048576

# =============================================================================
# Keep Alive and Timeouts
# =============================================================================

# Default keepalive (overridable by clients)
# max_keepalive 120

# =============================================================================
# Last Will and Testament
# =============================================================================

# Allow clients to set LWT
# Clients use this for presence detection

# =============================================================================
# Security Notes
# =============================================================================
#
# This configuration is for LAN-only communication within the salon.
# Security is provided by:
# 1. LAN isolation (broker not exposed to internet)
# 2. Topic-based access control in application layer
# 3. Message validation in application layer
#
# For production with internet access, enable:
# - TLS/SSL encryption
# - Username/password authentication
# - ACL file for topic restrictions
#
# Example TLS configuration (when certificates are available):
# listener 8883 0.0.0.0
# certfile /path/to/server.crt
# keyfile /path/to/server.key
# cafile /path/to/ca.crt
# require_certificate false
